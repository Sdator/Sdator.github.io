var e=Object.defineProperty,t=(t,l,a)=>(((t,l,a)=>{l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a})(t,"symbol"!=typeof l?l+"":l,a),a);import{c as l,o as a,r as n,p as o,a as s,b as d,d as u,e as r,t as i,w as c,f as b,v as p,g,h as m,u as v,i as f,j as h,F as y,k,l as S,m as U,n as j,q as w,s as x,x as C}from"./vendor.1199fc92.js";const M={setup:e=>(e,t)=>{const o=n("ShuruEx");return a(),l(o)},__scopeId:"data-v-0053ab60"},O=class{static get"取随机属性"(){return O.属性类目[B(O.属性类目.length)]}};let _=O;function B(e){return Math.floor(Math.random()*e)}t(_,"属性类目","\n  力量\n  敏捷\n  智力\n  生命\n  魔法\n  法防\n  物防\n  魔抗\n    ".trim().split("\n").map((e=>e.trim())));const D=class{constructor(){var e;return t(this,"data",[D.defaultData]),D.T=null!=(e=D.T)?e:this,D.T}get size(){return this.data.length}get list(){return this.data}add(e){e&&(e=Object.assign(D.defaultData,e));const t=Object.assign({},null!=e?e:{"属性":_.取随机属性,"长度":1,"地址":"0x"+B(1e5).toString(16).toUpperCase(),"数值":B(500)});this.data.push(t),console.log("DB:插入数据")}del(e=this.size-1){this.data.splice(e,1),console.log("DB:删除数据")}};let V=D;t(V,"defaultData",{"属性":_.取随机属性,"长度":1,"地址":"0x10","自定义值":500,"原始值":0,"备注":"test"}),new V;o("data-v-6c669947");const T={class:"inputs"},N=f(" 属性："),I=f(" 长度："),F=f(" 地址："),J=f(" 自定义值："),L=f(" 原始值："),R=f(" 提示：");s();const $={props:{blob:Object,endian:Boolean,data:{type:Object,default:{"属性":"力量","长度":1,"地址":"0x10","原始值":500,"自定义值":500,"备注":"test",addr:200}}},setup(e){const t=e,n=d(!1),o=u((()=>({color:n.value?"darkgreen":"red",backgroundColor:n.value?"aquamarine":"#000"}))),s=u((()=>t.blob?n.value?"读取成功":"地址超出范围":(n.value=!1,"还没有读入文件"))),f=r(t.data),{"长度":h,"地址":y}=i(f);return c([h,y],(([e,l])=>{if(!t.blob)return;const a=t.blob;let o=new Number(l);if(console.log(o,a.byteLength,"长度检查"),o>a.byteLength)return console.log("大于"),void(n.value=!1);n.value=!0,console.log("数据更新",n.value,a,a.byteLength);const s=new DataView(a);let d=0;switch(e){case 1:d=s.getUint8(o);break;case 2:d=s.getUint16(o);break;case 4:d=s.getUint32(o);break;default:return}t.data.原始值=d,console.log(s,22222222)})),(t,n)=>(a(),l("div",T,[N,b(g("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=t=>e.data.属性=t)},null,512),[[p,e.data.属性]]),I,b(g("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=t=>e.data.长度=t)},null,512),[[p,e.data.长度,void 0,{number:!0}]]),F,b(g("input",{type:"text","onUpdate:modelValue":n[3]||(n[3]=t=>e.data.地址=t)},null,512),[[p,e.data.地址]]),J,b(g("input",{type:"text","onUpdate:modelValue":n[4]||(n[4]=t=>e.data.自定义值=t),placeholder:"修改的值"},null,512),[[p,e.data.自定义值]]),L,g("label",null,m(e.data.原始值),1),R,g("label",{style:v(o)},m(v(s)),5),g("button",{onClick:n[5]||(n[5]=e=>t.$emit("remote"))},"❌")]))},__scopeId:"data-v-6c669947"};const q={emits:["blob"],setup(e,{emit:t}){const{inNesFile:n,inJson:o}=function(){const e=r({inNesFile:null,inJson:null});return i(e)}(),s=d(),p=d("把文件拖放进来"),f=d(!1),S=u((()=>({color:f.value?"darkgreen":"red",backgroundColor:f.value?"aquamarine":"#000"})));function U(){var e,t;const l=null!=(t=null==(e=s.value)?void 0:e.name)?t:"db";!function(e,t){const l=URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),a=document.createElement("a");a.style.display="none",a.href=l,a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)}(localStorage.config,`${l}_${Date.now()}.json`)}const j=(e,t)=>{s.value=null!=t?t:e.target.files[0],f.value=!0,p.value="得到文件:"+s.value.name,console.log("得到文件",s)};function w(e){let t=e.dataTransfer.files;if(!t.length)throw new Error("未找到文件");j(e,t[0]),console.log("在放置区域中释放拖放")}try{c(s,(async(e,l)=>{console.log(s.value.name,"文件发生变化"),""!=s.value.name&&(t("blob",await function(e){return new Promise((t=>{var l=new FileReader;l.onload=function(e){t(e.target.result)},l.readAsArrayBuffer(e)}))}(s.value)),console.log("二进制读取完毕：往父组件发送事件"))}))}catch(x){console.log(x,"读取文件失败")}return(e,t)=>(a(),l(y,null,[g("div",{onDragover:t[1]||(t[1]=h(((...t)=>e.dragover&&e.dragover(...t)),["prevent"])),onDrop:h(w,["prevent"]),class:"drop",style:v(S)},m(p.value),45,["onDrop"]),b(g("input",{ref:n,type:"file",onChange:j},null,544),[[k,!1]]),g("button",{onClick:t[2]||(t[2]=e=>v(n).click())},"导入要修改的文件"),g("button",{onClick:t[3]||(t[3]=(...t)=>e.exNesFile&&e.exNesFile(...t)),disabled:""},"确认修改并导出文件"),b(g("input",{ref:o,type:"file"},null,512),[[k,!1]]),g("button",{onClick:U},"导出json"),g("button",{onClick:t[4]||(t[4]=e=>v(o).click()),disabled:""},"导入json")],64))},__scopeId:"data-v-4d0dfad1"};o("data-v-0b31349c");const z={class:"shuru"},A=g("br",null,null,-1);s();const E={name:"Shuru",components:{Tiaomu:$,InFiles:q}};const P=Object.assign(E,{setup:function(e){const t=d(new V),n=d(t.value.data);c(n.value,((e,t)=>{console.log(e,t,"监听")}));const o=d();function s(e){o.value=e}return(e,d)=>(a(),l("div",z,[g(q,{onBlob:s}),A,g("button",{class:"add",onClick:d[1]||(d[1]=e=>t.value.add())},"添加"),(a(!0),l(y,null,S(n.value,((e,n)=>(a(),l($,{blob:o.value,key:n,data:e,onDel:e=>t.value.del(n)},null,8,["blob","data","onDel"])))),128))]))}});P.__scopeId="data-v-0b31349c";const G={props:{blob:Object,endian:Boolean,data:Object,bigModel:Boolean},setup(e){const t=e;const{classStatus:n,msgClass:o,msg:s}=function(){const e=r({classStatus:!1,msgClass:u((()=>({color:e.classStatus?"darkgreen":"red",backgroundColor:e.classStatus?"aquamarine":"#000"}))),msg:u((()=>t.blob?e.classStatus?"读取成功":"地址超出范围":(e.classStatus=!1,"还没有读入文件")))});return i(e)}(),d=r(t.data),{"长度":c,"地址":f}=i(d);function h(e=!1){const l=t.blob;if(!(l instanceof ArrayBuffer))return;let a=1*f.value;if(!a||a>l.byteLength||c.value>4)return void(n.value=!1);n.value=!0;const o=new DataView(l);let s=0;switch(c.value){case 1:s=o.getUint8(a);break;case 2:s=o.getUint16(a,t.bigModel);break;case 4:s=o.getUint32(a,t.bigModel);break;default:return}return e?/(.{2})(.{2})(.{2})(.{2})/g.exec(s.toString(16).padStart(8,0)):s}const y=r({"十六进制":u((()=>h(!0))),"十进制":u((()=>h(!1)))}),{"十六进制":k,"十进制":S}=i(y);return(t,n)=>(a(),l("tbody",null,[g("tr",null,[g("td",null,[b(g("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=t=>e.data.属性=t)},null,512),[[p,e.data.属性,void 0,{trim:!0}]])]),g("td",null,[b(g("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=t=>e.data.长度=t)},null,512),[[p,e.data.长度,void 0,{number:!0}]])]),g("td",null,[b(g("input",{class:"zhong",type:"text","onUpdate:modelValue":n[3]||(n[3]=t=>e.data.地址=t),placeholder:"十六进制"},null,512),[[p,e.data.地址,void 0,{trim:!0}]])]),g("td",null,[b(g("input",{type:"number","onUpdate:modelValue":n[4]||(n[4]=t=>e.data.自定义值=t),placeholder:"十进制"},null,512),[[p,e.data.自定义值]])]),g("td",null,[b(g("input",{class:"zhong",type:"text","onUpdate:modelValue":n[5]||(n[5]=t=>e.data.备注=t),placeholder:"详细描述"},null,512),[[p,e.data.备注]])]),g("td",null,[g("label",null,m(v(k)),1)]),g("td",null,[g("label",null,m(v(S)),1)]),g("td",null,[g("label",{class:"msg",style:v(o)},m(v(s)),5)]),g("th",null,[g("button",{onClick:n[6]||(n[6]=l=>t.$emit("remote",e.data))},"❌")]),U(t.$slots,"default",{},void 0,!0)])]))},__scopeId:"data-v-1b9df0e7"};const H=x();o("data-v-5df1b71c");const K={class:"样式功能按钮"},Q=g("br",null,null,-1),W=g("br",null,null,-1);s();const X={name:"Tab",props:{blob:Object},data:()=>({db:[],bigModel:!0,key:0,th:["属性","长度","地址","自定义值","备注","十六进制","十进制","提示"],"模糊搜索":""}),created(){var e;const t=JSON.parse(null!=(e=null==localStorage?void 0:localStorage.config)?e:"{}");"{}"!=JSON.stringify(t)&&(console.log("{}"==JSON.stringify(t),55555555),this.db=t.db,this.bigModel=t.bigModel)},methods:{addTodo(){const e={id:this.key++,"属性":_.取随机属性,"长度":1,"地址":"0x"+B(5e4).toString(16).toUpperCase(),"自定义值":"","备注":""};this.db.push(e),console.log("DB:添加数据",e)},remoteTodo(e){this.db=this.db.filter((t=>e.id!==t.id)),console.log("DB:删除数据",e)}},computed:{fildb(){const e={db:this.db,bigModel:this.bigModel};return localStorage.config=JSON.stringify(e),this.db.filter((e=>{if(this.模糊搜索){let t="";for(const l of Object.entries(e))t+=l.join("\n");return t.includes(this.模糊搜索)}return!0}))}}},Y=Object.assign(X,{setup:function(e){return(t,n)=>(a(),l(y,null,[g("div",K,[g("button",{class:"add",onClick:n[1]||(n[1]=(...e)=>t.addTodo&&t.addTodo(...e))},"添加"),b(g("input",{type:"text","onUpdate:modelValue":n[2]||(n[2]=e=>j(模糊搜索)?模糊搜索.value=e:null),placeholder:"模糊搜索"},null,512),[[p,t.模糊搜索]])]),g("label",null,m(t.bigModel?"大端:":"小端："),1),b(g("input",{type:"checkbox","onUpdate:modelValue":n[3]||(n[3]=e=>j(bigModel)?bigModel.value=e:null)},null,512),[[w,t.bigModel]]),Q,W,g("table",null,[g("thead",null,[g("tr",null,[(a(!0),l(y,null,S(t.th,((e,t)=>(a(),l("th",{key:t},m(e),1)))),128))])]),(a(!0),l(y,null,S(t.fildb,(n=>(a(),l(G,{blob:e.blob,key:n.id,data:n,onRemote:t.remoteTodo,bigModel:t.bigModel},{default:H((()=>[f(m(n.id),1)])),_:2},1032,["blob","data","onRemote","bigModel"])))),128))])],64))}});Y.__scopeId="data-v-5df1b71c";o("data-v-f5dcdbf2");const Z={class:"shuru"},ee=g("br",null,null,-1);s();const te={name:"ShuruEx",data:()=>({blob:{}}),methods:{setBlob(e){console.log("收到子组件数据",e),this.blob=e}}},le=Object.assign(te,{setup:function(e){return(e,t)=>(a(),l("div",Z,[g(q,{onBlob:e.setBlob},null,8,["onBlob"]),ee,g(Y,{blob:e.blob},null,8,["blob"])]))}});le.__scopeId="data-v-f5dcdbf2";const ae={install:function(e){e.component(P.name,P),e.component(le.name,le)}};C(M).use(ae).mount("#app");
