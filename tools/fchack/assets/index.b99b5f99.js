var e=Object.defineProperty,t=(t,l,n)=>(((t,l,n)=>{l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n})(t,"symbol"!=typeof l?l+"":l,n),n);import{o as l,c as n,a,F as o,r as s,p as u,b as d,d as i,e as c,f as r,t as b,w as p,g as m,v as g,h as f,u as v,i as h,j as y,k,l as S,m as x,n as U,q as w,s as C,x as j}from"./vendor.9de4ace2.js";const O={},B=a("kbd",{"mdui-tooltip":"{content: '不管在身在何处 我都会提醒自己 不要忘记自己活在现实中 QQ:250740270',position: 'top',delay: 500}"}," 制作：絕 ",-1),D=a("kbd",null," 赞助：七哥",-1);O.render=function(e,t,a,o,s,u){return l(),n("footer",null,[B,D])};const M={setup:e=>(e,t)=>{const u=s("ShuruEx");return l(),n(o,null,[a(u),a(O)],64)},__scopeId:"data-v-d1dd5bb8"},_=class{static get"取随机属性"(){return _.属性类目[J(_.属性类目.length)]}};let E=_;function J(e){return Math.floor(Math.random()*e)}t(E,"属性类目","\n  力量\n  敏捷\n  智力\n  生命\n  魔法\n  法防\n  物防\n  魔抗\n    ".trim().split("\n").map((e=>e.trim())));const V=class{constructor(){var e;return t(this,"data",[V.defaultData]),V.T=null!=(e=V.T)?e:this,V.T}get size(){return this.data.length}get list(){return this.data}add(e){e&&(e=Object.assign(V.defaultData,e));const t=Object.assign({},null!=e?e:{"属性":E.取随机属性,"长度":1,"地址":"0x"+J(1e5).toString(16).toUpperCase(),"数值":J(500)});this.data.push(t),console.log("DB:插入数据")}del(e=this.size-1){this.data.splice(e,1),console.log("DB:删除数据")}};let F=V;t(F,"defaultData",{"属性":E.取随机属性,"长度":1,"地址":"0x10","自定义值":500,"原始值":0,"备注":"test"}),new F;u("data-v-6c669947");const N={class:"inputs"},I=h(" 属性："),L=h(" 长度："),A=h(" 地址："),R=h(" 自定义值："),T=h(" 原始值："),$=h(" 提示：");d();const q={props:{blob:Object,endian:Boolean,data:{type:Object,default:{"属性":"力量","长度":1,"地址":"0x10","原始值":500,"自定义值":500,"备注":"test",addr:200}}},setup(e){const t=e,o=i(!1),s=c((()=>({color:o.value?"darkgreen":"red",backgroundColor:o.value?"aquamarine":"#000"}))),u=c((()=>t.blob?o.value?"读取成功":"地址超出范围":(o.value=!1,"还没有读入文件"))),d=r(t.data),{"长度":h,"地址":y}=b(d);return p([h,y],(([e,l])=>{if(!t.blob)return;const n=t.blob;let a=new Number(l);if(console.log(a,n.byteLength,"长度检查"),a>n.byteLength)return console.log("大于"),void(o.value=!1);o.value=!0,console.log("数据更新",o.value,n,n.byteLength);const s=new DataView(n);let u=0;switch(e){case 1:u=s.getUint8(a);break;case 2:u=s.getUint16(a);break;case 4:u=s.getUint32(a);break;default:return}t.data.原始值=u,console.log(s,22222222)})),(t,o)=>(l(),n("div",N,[I,m(a("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=t=>e.data.属性=t)},null,512),[[g,e.data.属性]]),L,m(a("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=t=>e.data.长度=t)},null,512),[[g,e.data.长度,void 0,{number:!0}]]),A,m(a("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>e.data.地址=t)},null,512),[[g,e.data.地址]]),R,m(a("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>e.data.自定义值=t),placeholder:"修改的值"},null,512),[[g,e.data.自定义值]]),T,a("label",null,f(e.data.原始值),1),$,a("label",{style:v(s)},f(v(u)),5),a("button",{onClick:o[5]||(o[5]=e=>t.$emit("remote"))},"❌")]))},__scopeId:"data-v-6c669947"};const z={emits:["blob","update"],setup(e,{emit:t}){const{inNesFileEl:s,getFile:u,file:d,msg:i,msgClass:g}=function(){const e=r({inNesFileEl:null,classStatus:!1,msg:"把文件拖放进来",file:null,getFile(t){var l,n,a,o;const s=null!=(o=null==(n=null==(l=t.dataTransfer)?void 0:l.files)?void 0:n[0])?o:null==(a=t.target.files)?void 0:a[0];if(!s)throw new Error("未找到文件");e.classStatus=!0,e.msg="得到文件:"+s.name,e.file=s,console.log("得到文件",s)},msgClass:c((()=>({color:e.classStatus?"darkgreen":"red",backgroundColor:e.classStatus?"aquamarine":"#000"})))});try{p((()=>e.file),(async l=>{console.log("文件发生变化",l),(null==l?void 0:l.size)?(t("blob",await function(e){return new Promise((t=>{var l=new FileReader;l.onload=function(e){t(e.target.result)},l.readAsArrayBuffer(e)}))}(e.file)),console.log("二进制读取完毕：往父组件发送事件")):e.msg="文件似乎有问题"}))}catch(l){console.log(l,"读取文件失败")}return b(e)}();const{inJsonEl:h,exJsonFile:S,inJson:x}=function(){const e=r({inJsonEl:null,async inJson(e){var l;const n=null==(l=e.target.files)?void 0:l[0];if("application/json"!=n.type)return void alert("文件格式错误");const a=await n.text(),o=JSON.parse(null!=a?a:{});"{}"!=JSON.stringify(o)&&(console.log("导入文件",o),t("update",o))},exJsonFile(){var e,t;const l=null!=(t=null==(e=d.value)?void 0:e.name)?t:"db";!function(e,t){const l=URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),n=document.createElement("a");n.style.display="none",n.href=l,n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(localStorage.config,`${l}_${Date.now()}.json`)}});return b(e)}();return(e,t)=>(l(),n(o,null,[a("div",{onDragover:t[1]||(t[1]=y(((...t)=>e.dragover&&e.dragover(...t)),["prevent"])),onDrop:t[2]||(t[2]=y(((...e)=>v(u)&&v(u)(...e)),["prevent"])),class:"drop",style:v(g)},f(v(i)),37),m(a("input",{ref:s,type:"file",onChange:t[3]||(t[3]=(...e)=>v(u)&&v(u)(...e))},null,544),[[k,!1]]),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[4]||(t[4]=e=>v(s).click())}," 导入要修改的文件 "),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[5]||(t[5]=(...t)=>e.exNesFile&&e.exNesFile(...t)),disabled:""}," 确认修改并导出文件 "),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[6]||(t[6]=(...e)=>v(S)&&v(S)(...e))}," 导出json "),m(a("input",{ref:h,type:"file",onChange:t[7]||(t[7]=(...e)=>v(x)&&v(x)(...e))},null,544),[[k,!1]]),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[8]||(t[8]=e=>v(h).click())}," 导入json ")],64))},__scopeId:"data-v-dc194246"};u("data-v-0b31349c");const P={class:"shuru"},Q=a("br",null,null,-1);d();const G={name:"Shuru",components:{Tiaomu:q,InFiles:z}};const H=Object.assign(G,{setup:function(e){const t=i(new F),s=i(t.value.data);p(s.value,((e,t)=>{console.log(e,t,"监听")}));const u=i();function d(e){u.value=e}return(e,i)=>(l(),n("div",P,[a(z,{onBlob:d}),Q,a("button",{class:"add",onClick:i[1]||(i[1]=e=>t.value.add())},"添加"),(l(!0),n(o,null,S(s.value,((e,a)=>(l(),n(q,{blob:u.value,key:a,data:e,onDel:e=>t.value.del(a)},null,8,["blob","data","onDel"])))),128))]))}});H.__scopeId="data-v-0b31349c";const K={props:{blob:Object,endian:Boolean,data:Object,bigModel:Boolean},setup(e){const t=e;const{classStatus:o,msgClass:s,msg:u}=function(){const e=r({classStatus:!1,msgClass:c((()=>({color:e.classStatus?"darkgreen":"red",backgroundColor:e.classStatus?"aquamarine":"#000"}))),msg:c((()=>t.blob instanceof ArrayBuffer?e.classStatus?"读取成功":"地址超出范围":(e.classStatus=!1,"还没有读入文件")))});return b(e)}(),d=r(t.data),{"长度":i,"地址":p}=b(d);function h(e=!1){const l=t.blob;if(!(l instanceof ArrayBuffer))return;let n=1*p.value;if(!n||n>l.byteLength||i.value>4)return void(o.value=!1);o.value=!0;const a=new DataView(l);let s=0;switch(i.value){case 1:s=a.getUint8(n);break;case 2:s=a.getUint16(n,t.bigModel);break;case 4:s=a.getUint32(n,t.bigModel);break;default:return}return e?/(.{2})(.{2})(.{2})(.{2})/g.exec(s.toString(16).padStart(8,0)):s}const y=r({"十六进制":c((()=>h(!0))),"十进制":c((()=>h(!1)))}),{"十六进制":k,"十进制":S}=b(y);return(t,o)=>(l(),n("tbody",null,[a("tr",null,[a("td",null,[m(a("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=t=>e.data.属性=t)},null,512),[[g,e.data.属性,void 0,{trim:!0}]])]),a("td",null,[m(a("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=t=>e.data.长度=t)},null,512),[[g,e.data.长度,void 0,{number:!0}]])]),a("td",null,[m(a("input",{class:"zhong",type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>e.data.地址=t),placeholder:"十六进制"},null,512),[[g,e.data.地址,void 0,{trim:!0}]])]),a("td",null,[m(a("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=t=>e.data.自定义值=t),placeholder:"十进制"},null,512),[[g,e.data.自定义值]])]),a("td",null,[a("label",null,f(v(k)),1)]),a("td",null,[a("label",null,f(v(S)),1)]),a("td",null,[a("label",{class:"msg",style:v(s)},f(v(u)),5)]),a("th",null,[a("button",{onClick:o[5]||(o[5]=l=>t.$emit("remote",e.data))},"❌")]),x(t.$slots,"default",{},void 0,!0)])]))},__scopeId:"data-v-50c8f816"};u("data-v-3fff4ce1");const W={class:"样式功能按钮"},X={class:"mdui-textfield mdui-textfield-floating-label"},Y=a("label",{class:"mdui-textfield-label"},"模糊搜索",-1),Z=a("br",null,null,-1),ee=a("br",null,null,-1),te={class:"mdui-table-fluid"},le={class:"mdui-table mdui-table-hoverable mdui-container-flui"};d();const ne={props:{blob:Object,update:Object},setup(e){const t=e;const{addEntry:s,remoteEntry:u,db:d,bigModel:i,fildb:c,"模糊搜索":h}=function(){const e=r({"模糊搜索":"",db:[],bigModel:!0,remoteEntry(t){e.db=e.db.filter((e=>t.id!==e.id)),console.log("DB:删除数据",t)},addEntry(){const t={id:Date.now(),"属性":E.取随机属性,"长度":1,"地址":"0x"+J(5e4).toString(16).toUpperCase(),"自定义值":"","备注":"","序列":0};e.db.push(t),console.log("DB:添加数据",t)},fildb:C((()=>{const t={db:e.db,bigModel:e.bigModel};localStorage.config=JSON.stringify(t),console.log("数据发生变化",e.db);return e.db.filter((t=>{if(e.模糊搜索){let l="";for(const e of Object.entries(t))l+=e.join("\n");return l.includes(e.模糊搜索)}return!0}))}))});return p((()=>t.update),(t=>{console.log("收到邻居数据更新db",t),e.bigModel=t.bigModel,e.db=t.db})),function(){var t,l,n,a;try{const o=JSON.parse(null!=(t=localStorage.config)?t:"{}");"{}"!==JSON.stringify(o)&&(e.db=null!=(l=null==o?void 0:o.db)?l:e.db,e.bigModel=null!=(n=null==o?void 0:o.bigModel)?n:e.bigModel);const s=null!=(a=null==localStorage?void 0:localStorage.db)?a:null;s&&(e.db=JSON.parse(null!=s?s:"[]"),localStorage.removeItem("db"))}catch(o){localStorage.removeItem("config")}}(),b(e)}(),y=["属性","长度","地址","自定义值","十六进制","十进制","提示","功能"];return(t,d)=>(l(),n(o,null,[a("div",W,[a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:d[1]||(d[1]=(...e)=>v(s)&&v(s)(...e))}," 添加条目 ")]),a("div",X,[Y,m(a("input",{class:"mdui-textfield-input",type:"text","onUpdate:modelValue":d[2]||(d[2]=e=>U(h)?h.value=e:null)},null,512),[[g,v(h)]])]),a("label",null,f(v(i)?"大端:":"小端："),1),m(a("input",{type:"checkbox","onUpdate:modelValue":d[3]||(d[3]=e=>U(i)?i.value=e:null)},null,512),[[w,v(i)]]),Z,ee,a("div",te,[a("table",le,[a("thead",null,[a("tr",null,[(l(),n(o,null,S(y,((e,t)=>a("th",{key:t},f(e),1))),64))])]),(l(!0),n(o,null,S(v(c),(t=>(l(),n(K,{blob:e.blob,key:t.id,data:t,onRemote:v(u),bigModel:v(i)},null,8,["blob","data","onRemote","bigModel"])))),128))])])],64))},__scopeId:"data-v-3fff4ce1"};u("data-v-c33a1c92");const ae={class:"shuru"},oe=a("br",null,null,-1);d();const se={name:"ShuruEx",data:()=>({blob:{},update:{}}),methods:{setBlob(e){console.log("收到子组件数据",e),this.blob=e},setDB(e){console.log("收到子组件数据",e),this.update=e}}},ue=Object.assign(se,{setup:function(e){return(e,t)=>(l(),n("div",ae,[a(z,{onBlob:e.setBlob,onUpdate:e.setDB},null,8,["onBlob","onUpdate"]),oe,a(ne,{blob:e.blob,update:e.update},null,8,["blob","update"])]))}});ue.__scopeId="data-v-c33a1c92";const de={install:function(e){e.component(H.name,H),e.component(ue.name,ue)}};j(M).use(de).mount("#app");
