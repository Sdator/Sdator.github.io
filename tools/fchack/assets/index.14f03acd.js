var e=Object.defineProperty,l=(l,t,a)=>(((l,t,a)=>{t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a})(l,"symbol"!=typeof t?t+"":t,a),a);import{o as t,c as a,a as n,F as o,r as u,p as s,b as d,d as i,e as c,f as r,t as b,w as p,g as m,v as g,h as v,u as f,i as h,j as y,k,l as S,m as x,n as U,q as w,s as j,x as C}from"./vendor.dfc78ee7.js";const B={},O=n("kbd",{"mdui-tooltip":"{content: '不管在身在何处 我都会提醒自己 不要忘记自己活在现实中 QQ:250740270',position: 'top',delay: 500}"}," 制作：絕 ",-1),D=n("kbd",null," 赞助：七哥",-1);B.render=function(e,l,n,o,u,s){return t(),a("footer",null,[O,D])};const _={setup:e=>(e,l)=>{const s=u("ShuruEx");return t(),a(o,null,[n(s),n(B)],64)},__scopeId:"data-v-d1dd5bb8"},M=class{static get"取随机属性"(){return M.属性类目[I(M.属性类目.length)]}};let V=M;function I(e){return Math.floor(Math.random()*e)}l(V,"属性类目","\n  力量\n  敏捷\n  智力\n  生命\n  魔法\n  法防\n  物防\n  魔抗\n    ".trim().split("\n").map((e=>e.trim())));const N=class{constructor(){var e;return l(this,"data",[N.defaultData]),N.T=null!=(e=N.T)?e:this,N.T}get size(){return this.data.length}get list(){return this.data}add(e){e&&(e=Object.assign(N.defaultData,e));const l=Object.assign({},null!=e?e:{"属性":V.取随机属性,"长度":1,"地址":"0x"+I(1e5).toString(16).toUpperCase(),"数值":I(500)});this.data.push(l),console.log("DB:插入数据")}del(e=this.size-1){this.data.splice(e,1),console.log("DB:删除数据")}};let T=N;l(T,"defaultData",{"属性":V.取随机属性,"长度":1,"地址":"0x10","自定义值":500,"原始值":0,"备注":"test"}),new T;s("data-v-6c669947");const F={class:"inputs"},J=h(" 属性："),L=h(" 长度："),A=h(" 地址："),R=h(" 自定义值："),$=h(" 原始值："),q=h(" 提示：");d();const z={props:{blob:Object,endian:Boolean,data:{type:Object,default:{"属性":"力量","长度":1,"地址":"0x10","原始值":500,"自定义值":500,"备注":"test",addr:200}}},setup(e){const l=e,o=i(!1),u=c((()=>({color:o.value?"darkgreen":"red",backgroundColor:o.value?"aquamarine":"#000"}))),s=c((()=>l.blob?o.value?"读取成功":"地址超出范围":(o.value=!1,"还没有读入文件"))),d=r(l.data),{"长度":h,"地址":y}=b(d);return p([h,y],(([e,t])=>{if(!l.blob)return;const a=l.blob;let n=new Number(t);if(console.log(n,a.byteLength,"长度检查"),n>a.byteLength)return console.log("大于"),void(o.value=!1);o.value=!0,console.log("数据更新",o.value,a,a.byteLength);const u=new DataView(a);let s=0;switch(e){case 1:s=u.getUint8(n);break;case 2:s=u.getUint16(n);break;case 4:s=u.getUint32(n);break;default:return}l.data.原始值=s,console.log(u,22222222)})),(l,o)=>(t(),a("div",F,[J,m(n("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=l=>e.data.属性=l)},null,512),[[g,e.data.属性]]),L,m(n("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=l=>e.data.长度=l)},null,512),[[g,e.data.长度,void 0,{number:!0}]]),A,m(n("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=l=>e.data.地址=l)},null,512),[[g,e.data.地址]]),R,m(n("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=l=>e.data.自定义值=l),placeholder:"修改的值"},null,512),[[g,e.data.自定义值]]),$,n("label",null,v(e.data.原始值),1),q,n("label",{style:f(u)},v(f(s)),5),n("button",{onClick:o[5]||(o[5]=e=>l.$emit("remote"))},"❌")]))},__scopeId:"data-v-6c669947"};const E={emits:["blob"],setup(e,{emit:l}){const{inNesFile:u,inJson:s}=function(){const e=r({inNesFile:null,inJson:null});return b(e)}(),d=i(),g=i("把文件拖放进来"),h=i(!1),S=c((()=>({color:h.value?"darkgreen":"red",backgroundColor:h.value?"aquamarine":"#000"})));function x(){var e,l;const t=null!=(l=null==(e=d.value)?void 0:e.name)?l:"db";!function(e,l){const t=URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),a=document.createElement("a");a.style.display="none",a.href=t,a.setAttribute("download",l),document.body.appendChild(a),a.click(),document.body.removeChild(a)}(localStorage.config,`${t}_${Date.now()}.json`)}const U=(e,l)=>{d.value=null!=l?l:e.target.files[0],h.value=!0,g.value="得到文件:"+d.value.name,console.log("得到文件",d)};function w(e){let l=e.dataTransfer.files;if(!l.length)throw new Error("未找到文件");U(e,l[0]),console.log("在放置区域中释放拖放")}try{p(d,(async(e,t)=>{console.log(d.value.name,"文件发生变化"),""!=d.value.name&&(l("blob",await function(e){return new Promise((l=>{var t=new FileReader;t.onload=function(e){l(e.target.result)},t.readAsArrayBuffer(e)}))}(d.value)),console.log("二进制读取完毕：往父组件发送事件"))}))}catch(j){console.log(j,"读取文件失败")}return(e,l)=>(t(),a(o,null,[n("div",{onDragover:l[1]||(l[1]=y(((...l)=>e.dragover&&e.dragover(...l)),["prevent"])),onDrop:y(w,["prevent"]),class:"drop",style:f(S)},v(g.value),45,["onDrop"]),m(n("input",{ref:u,type:"file",onChange:U},null,544),[[k,!1]]),n("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:l[2]||(l[2]=e=>f(u).click())}," 导入要修改的文件 "),n("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:l[3]||(l[3]=(...l)=>e.exNesFile&&e.exNesFile(...l)),disabled:""}," 确认修改并导出文件 "),m(n("input",{ref:s,type:"file"},null,512),[[k,!1]]),n("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:x}," 导出json "),n("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:l[4]||(l[4]=e=>f(s).click()),disabled:""}," 导入json ")],64))},__scopeId:"data-v-985a97c4"};s("data-v-0b31349c");const P={class:"shuru"},Q=n("br",null,null,-1);d();const G={name:"Shuru",components:{Tiaomu:z,InFiles:E}};const H=Object.assign(G,{setup:function(e){const l=i(new T),u=i(l.value.data);p(u.value,((e,l)=>{console.log(e,l,"监听")}));const s=i();function d(e){s.value=e}return(e,i)=>(t(),a("div",P,[n(E,{onBlob:d}),Q,n("button",{class:"add",onClick:i[1]||(i[1]=e=>l.value.add())},"添加"),(t(!0),a(o,null,S(u.value,((e,n)=>(t(),a(z,{blob:s.value,key:n,data:e,onDel:e=>l.value.del(n)},null,8,["blob","data","onDel"])))),128))]))}});H.__scopeId="data-v-0b31349c";const K={props:{blob:Object,endian:Boolean,data:Object,bigModel:Boolean},setup(e){const l=e;const{classStatus:o,msgClass:u,msg:s}=function(){const e=r({classStatus:!1,msgClass:c((()=>({color:e.classStatus?"darkgreen":"red",backgroundColor:e.classStatus?"aquamarine":"#000"}))),msg:c((()=>l.blob instanceof ArrayBuffer?e.classStatus?"读取成功":"地址超出范围":(e.classStatus=!1,"还没有读入文件")))});return b(e)}(),d=r(l.data),{"长度":i,"地址":p}=b(d);function h(e=!1){const t=l.blob;if(!(t instanceof ArrayBuffer))return;let a=1*p.value;if(!a||a>t.byteLength||i.value>4)return void(o.value=!1);o.value=!0;const n=new DataView(t);let u=0;switch(i.value){case 1:u=n.getUint8(a);break;case 2:u=n.getUint16(a,l.bigModel);break;case 4:u=n.getUint32(a,l.bigModel);break;default:return}return e?/(.{2})(.{2})(.{2})(.{2})/g.exec(u.toString(16).padStart(8,0)):u}const y=r({"十六进制":c((()=>h(!0))),"十进制":c((()=>h(!1)))}),{"十六进制":k,"十进制":S}=b(y);return(l,o)=>(t(),a("tbody",null,[n("tr",null,[n("td",null,v(e.data.id),1),n("td",null,[m(n("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=l=>e.data.属性=l)},null,512),[[g,e.data.属性,void 0,{trim:!0}]])]),n("td",null,[m(n("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=l=>e.data.长度=l)},null,512),[[g,e.data.长度,void 0,{number:!0}]])]),n("td",null,[m(n("input",{class:"zhong",type:"text","onUpdate:modelValue":o[3]||(o[3]=l=>e.data.地址=l),placeholder:"十六进制"},null,512),[[g,e.data.地址,void 0,{trim:!0}]])]),n("td",null,[m(n("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=l=>e.data.自定义值=l),placeholder:"十进制"},null,512),[[g,e.data.自定义值]])]),n("td",null,[m(n("input",{class:"zhong",type:"text","onUpdate:modelValue":o[5]||(o[5]=l=>e.data.备注=l),placeholder:"详细描述"},null,512),[[g,e.data.备注]])]),n("td",null,[n("label",null,v(f(k)),1)]),n("td",null,[n("label",null,v(f(S)),1)]),n("td",null,[n("label",{class:"msg",style:f(u)},v(f(s)),5)]),n("th",null,[n("button",{onClick:o[6]||(o[6]=t=>l.$emit("remote",e.data))},"❌")]),x(l.$slots,"default",{},void 0,!0)])]))},__scopeId:"data-v-7dc95b69"};s("data-v-7130bb8c");const W={class:"样式功能按钮"},X={class:"mdui-textfield mdui-textfield-floating-label"},Y=n("label",{class:"mdui-textfield-label"},"模糊搜索",-1),Z=n("br",null,null,-1),ee=n("br",null,null,-1),le={class:"mdui-table-fluid"},te={class:"mdui-table mdui-table-hoverable mdui-container-flui"};d();const ae={props:{blob:Object},setup(e){const l=i("");const{addTodo:u,remoteTodo:s,db:d,bigModel:c,fildb:p}=function(){let e=0;const t=r({db:[],bigModel:!0,remoteTodo(e){t.db=t.db.filter((l=>e.id!==l.id)),console.log("DB:删除数据",e)},addTodo(){const l={id:e++,"属性":V.取随机属性,"长度":1,"地址":"0x"+I(5e4).toString(16).toUpperCase(),"自定义值":"","备注":""};t.db.push(l),console.log("DB:添加数据",l)},fildb:j((()=>{const e={db:t.db,bigModel:t.bigModel};console.log("数据发生变化",e),localStorage.config=JSON.stringify(e);return t.db.filter((e=>{if(l.value){let t="";for(const l of Object.entries(e))t+=l.join("\n");return t.includes(l.value)}return!0}))}))});return function(){var e,l,a,n;const o=JSON.parse(null!=(e=null==localStorage?void 0:localStorage.config)?e:"{}");"{}"!==JSON.stringify(o)&&(t.db=null!=(l=null==o?void 0:o.db)?l:t.db,t.bigModel=null!=(a=null==o?void 0:o.bigModel)?a:t.bigModel);const u=null!=(n=null==localStorage?void 0:localStorage.db)?n:null;u&&(t.db=JSON.parse(null!=u?u:"[]"),localStorage.removeItem("db"))}(),b(t)}(),h=["序列","属性","长度","地址","自定义值","备注","十六进制","十进制","提示","功能"];return(d,i)=>(t(),a(o,null,[n("div",W,[n("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:i[1]||(i[1]=(...e)=>f(u)&&f(u)(...e))}," 添加 ")]),n("div",X,[Y,m(n("input",{class:"mdui-textfield-input",type:"text","onUpdate:modelValue":i[2]||(i[2]=e=>l.value=e)},null,512),[[g,l.value]])]),n("label",null,v(f(c)?"大端:":"小端："),1),m(n("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=e=>w(c)?c.value=e:null)},null,512),[[U,f(c)]]),Z,ee,n("div",le,[n("table",te,[n("thead",null,[n("tr",null,[(t(),a(o,null,S(h,((e,l)=>n("th",{key:l},v(e),1))),64))])]),(t(!0),a(o,null,S(f(p),(l=>(t(),a(K,{blob:e.blob,key:l.id,data:l,onRemote:f(s),bigModel:f(c)},null,8,["blob","data","onRemote","bigModel"])))),128))])])],64))},__scopeId:"data-v-7130bb8c"};s("data-v-e9f7a4ba");const ne={class:"shuru"},oe=n("br",null,null,-1);d();const ue={name:"ShuruEx",data:()=>({blob:{}}),methods:{setBlob(e){console.log("收到子组件数据",e),this.blob=e}}},se=Object.assign(ue,{setup:function(e){return(e,l)=>(t(),a("div",ne,[n(E,{onBlob:e.setBlob},null,8,["onBlob"]),oe,n(ae,{blob:e.blob},null,8,["blob"])]))}});se.__scopeId="data-v-e9f7a4ba";const de={install:function(e){e.component(H.name,H),e.component(se.name,se)}};C(_).use(de).mount("#app");
