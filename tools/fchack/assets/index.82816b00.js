var e=Object.defineProperty,t=(t,l,n)=>(((t,l,n)=>{l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n})(t,"symbol"!=typeof l?l+"":l,n),n);import{o as l,c as n,a,F as o,r as s,p as u,b as d,d as i,e as c,f as r,t as b,w as p,g as m,v as g,h as f,u as v,i as h,j as y,k,l as S,m as w,n as x,q as U,s as C,x as j}from"./vendor.9de4ace2.js";const O={},B=a("kbd",{"mdui-tooltip":"{content: '不管在身在何处 我都会提醒自己 不要忘记自己活在现实中 QQ:250740270',position: 'top',delay: 500}"}," 制作：絕 ",-1),D=a("kbd",null," 赞助：七哥",-1);O.render=function(e,t,a,o,s,u){return l(),n("footer",null,[B,D])};const M={setup:e=>(e,t)=>{const u=s("ShuruEx");return l(),n(o,null,[a(u),a(O)],64)},__scopeId:"data-v-d1dd5bb8"},_=class{static get"取随机属性"(){return _.属性类目[E(_.属性类目.length)]}};let I=_;function V(e,t){const l=URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),n=document.createElement("a");n.style.display="none",n.href=l,n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}function E(e){return Math.floor(Math.random()*e)}t(I,"属性类目","\n  力量\n  敏捷\n  智力\n  生命\n  魔法\n  法防\n  物防\n  魔抗\n    ".trim().split("\n").map((e=>e.trim())));const J=class{constructor(){var e;return t(this,"data",[J.defaultData]),J.T=null!=(e=J.T)?e:this,J.T}get size(){return this.data.length}get list(){return this.data}add(e){e&&(e=Object.assign(J.defaultData,e));const t=Object.assign({},null!=e?e:{"属性":I.取随机属性,"长度":1,"地址":"0x"+E(1e5).toString(16).toUpperCase(),"数值":E(500)});this.data.push(t),console.log("DB:插入数据")}del(e=this.size-1){this.data.splice(e,1),console.log("DB:删除数据")}};let F=J;t(F,"defaultData",{"属性":I.取随机属性,"长度":1,"地址":"0x10","自定义值":500,"原始值":0,"备注":"test"}),new F;u("data-v-6c669947");const N={class:"inputs"},L=h(" 属性："),$=h(" 长度："),A=h(" 地址："),R=h(" 自定义值："),T=h(" 原始值："),q=h(" 提示：");d();const z={props:{blob:Object,endian:Boolean,data:{type:Object,default:{"属性":"力量","长度":1,"地址":"0x10","原始值":500,"自定义值":500,"备注":"test",addr:200}}},setup(e){const t=e,o=i(!1),s=c((()=>({color:o.value?"darkgreen":"red",backgroundColor:o.value?"aquamarine":"#000"}))),u=c((()=>t.blob?o.value?"读取成功":"地址超出范围":(o.value=!1,"还没有读入文件"))),d=r(t.data),{"长度":h,"地址":y}=b(d);return p([h,y],(([e,l])=>{if(!t.blob)return;const n=t.blob;let a=new Number(l);if(console.log(a,n.byteLength,"长度检查"),a>n.byteLength)return console.log("大于"),void(o.value=!1);o.value=!0,console.log("数据更新",o.value,n,n.byteLength);const s=new DataView(n);let u=0;switch(e){case 1:u=s.getUint8(a);break;case 2:u=s.getUint16(a);break;case 4:u=s.getUint32(a);break;default:return}t.data.原始值=u,console.log(s,22222222)})),(t,o)=>(l(),n("div",N,[L,m(a("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=t=>e.data.属性=t)},null,512),[[g,e.data.属性]]),$,m(a("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=t=>e.data.长度=t)},null,512),[[g,e.data.长度,void 0,{number:!0}]]),A,m(a("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>e.data.地址=t)},null,512),[[g,e.data.地址]]),R,m(a("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>e.data.自定义值=t),placeholder:"修改的值"},null,512),[[g,e.data.自定义值]]),T,a("label",null,f(e.data.原始值),1),q,a("label",{style:v(s)},f(v(u)),5),a("button",{onClick:o[5]||(o[5]=e=>t.$emit("remote"))},"❌")]))},__scopeId:"data-v-6c669947"};const P={emits:["blob","update"],setup(e,{emit:t}){const{inNesFileEl:s,getFile:u,exNesFile:d,file:i,msg:g,msgClass:h}=function(){let e=null;const l=r({inNesFileEl:null,classStatus:!1,msg:"把文件拖放进来",file:null,exNesFile(){var t,l;const n=JSON.parse(localStorage.getItem("config"));if(!n||!e)return void alert("没找到需要修改的数据");const a=new DataView(e);for(const{"地址":s,"长度":u,"自定义值":d}of n.db){if(!(1*s>e.byteLength||u>4))switch(u){case 1:a.setUint8(s,d);break;case 2:a.setUint16(s,d,n.bigModel);break;case 4:a.setUint32(s,d,n.bigModel)}}const o=null!=(l=null==(t=i.value)?void 0:t.name)?l:"db";a&&V(a,`new_${o}`)},getFile(e){var t,n,a,o;const s=null!=(o=null==(n=null==(t=e.dataTransfer)?void 0:t.files)?void 0:n[0])?o:null==(a=e.target.files)?void 0:a[0];if(!s)throw new Error("未找到文件");l.classStatus=!0,l.msg="得到文件:"+s.name,l.file=s,console.log("得到文件",s)},msgClass:c((()=>({color:l.classStatus?"darkgreen":"red",backgroundColor:l.classStatus?"aquamarine":"#000"})))});try{p((()=>l.file),(async n=>{console.log("文件发生变化",n),(null==n?void 0:n.size)?(e=await function(e){return new Promise((t=>{var l=new FileReader;l.onload=function(e){t(e.target.result)},l.readAsArrayBuffer(e)}))}(l.file),t("blob",e),console.log("二进制读取完毕：往父组件发送事件")):l.msg="文件似乎有问题"}))}catch(n){console.log(n,"读取文件失败")}return b(l)}();const{inJsonEl:S,exJsonFile:w,inJson:x}=function(){const e=r({inJsonEl:null,async inJson(e){var l;const n=null==(l=e.target.files)?void 0:l[0];if("application/json"!=n.type)return void alert("文件格式错误");const a=await n.text(),o=JSON.parse(null!=a?a:{});"{}"!=JSON.stringify(o)&&(console.log("导入文件",o),t("update",o))},exJsonFile(){var e,t;const l=null!=(t=null==(e=i.value)?void 0:e.name)?t:"db",n=localStorage.getItem("config");n&&V(n,`${l}_${Date.now()}.json`)}});return b(e)}();return(e,t)=>(l(),n(o,null,[a("div",{onDragover:t[1]||(t[1]=y(((...t)=>e.dragover&&e.dragover(...t)),["prevent"])),onDrop:t[2]||(t[2]=y(((...e)=>v(u)&&v(u)(...e)),["prevent"])),class:"drop",style:v(h)},f(v(g)),37),m(a("input",{ref:s,type:"file",onChange:t[3]||(t[3]=(...e)=>v(u)&&v(u)(...e))},null,544),[[k,!1]]),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[4]||(t[4]=e=>v(s).click())}," 导入要修改的文件 "),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[5]||(t[5]=(...e)=>v(d)&&v(d)(...e))}," 确认修改并导出文件 "),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[6]||(t[6]=(...e)=>v(w)&&v(w)(...e))}," 导出json "),m(a("input",{ref:S,type:"file",onChange:t[7]||(t[7]=(...e)=>v(x)&&v(x)(...e))},null,544),[[k,!1]]),a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:t[8]||(t[8]=e=>v(S).click())}," 导入json ")],64))},__scopeId:"data-v-327186b0"};u("data-v-0b31349c");const Q={class:"shuru"},G=a("br",null,null,-1);d();const H={name:"Shuru",components:{Tiaomu:z,InFiles:P}};const K=Object.assign(H,{setup:function(e){const t=i(new F),s=i(t.value.data);p(s.value,((e,t)=>{console.log(e,t,"监听")}));const u=i();function d(e){u.value=e}return(e,i)=>(l(),n("div",Q,[a(P,{onBlob:d}),G,a("button",{class:"add",onClick:i[1]||(i[1]=e=>t.value.add())},"添加"),(l(!0),n(o,null,S(s.value,((e,a)=>(l(),n(z,{blob:u.value,key:a,data:e,onDel:e=>t.value.del(a)},null,8,["blob","data","onDel"])))),128))]))}});K.__scopeId="data-v-0b31349c";const W={props:{blob:Object,endian:Boolean,data:Object,bigModel:Boolean},setup(e){const t=e;const{classStatus:o,msgClass:s,msg:u}=function(){const e=r({classStatus:!1,msgClass:c((()=>({color:e.classStatus?"darkgreen":"red",backgroundColor:e.classStatus?"aquamarine":"#000"}))),msg:c((()=>t.blob instanceof ArrayBuffer?e.classStatus?"读取成功":"地址超出范围":(e.classStatus=!1,"还没有读入文件")))});return b(e)}(),{"长度":d,"地址":i}=t.data;function p(e=!1){const l=t.blob;if(!(l instanceof ArrayBuffer))return;let n=1*i;if(n>l.byteLength||d>4)return void(o.value=!1);o.value=!0;const a=new DataView(l);let s=0;switch(d){case 1:s=a.getUint8(n);break;case 2:s=a.getUint16(n,t.bigModel);break;case 4:s=a.getUint32(n,t.bigModel);break;default:return}return e?/(.{2})(.{2})(.{2})(.{2})/g.exec(s.toString(16).padStart(8,0)):s}const h=r({"十六进制":c((()=>p(!0))),"十进制":c((()=>p(!1)))}),{"十六进制":y,"十进制":k}=b(h);return(t,o)=>(l(),n("tbody",null,[a("tr",null,[a("td",null,[m(a("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=t=>e.data.属性=t)},null,512),[[g,e.data.属性,void 0,{trim:!0}]])]),a("td",null,[m(a("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=t=>e.data.长度=t)},null,512),[[g,e.data.长度,void 0,{number:!0}]])]),a("td",null,[m(a("input",{class:"zhong",type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>e.data.地址=t),placeholder:"十六进制"},null,512),[[g,e.data.地址,void 0,{trim:!0}]])]),a("td",null,[m(a("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=t=>e.data.自定义值=t),placeholder:"十进制"},null,512),[[g,e.data.自定义值]])]),a("td",null,[a("label",null,f(v(y)),1)]),a("td",null,[a("label",null,f(v(k)),1)]),a("td",null,[a("label",{class:"msg",style:v(s)},f(v(u)),5)]),a("th",null,[a("button",{onClick:o[5]||(o[5]=l=>t.$emit("remote",e.data))},"❌")]),w(t.$slots,"default",{},void 0,!0)])]))},__scopeId:"data-v-b7a26172"};u("data-v-41f9a38a");const X={class:"样式功能按钮"},Y={class:"mdui-textfield mdui-textfield-floating-label"},Z=a("label",{class:"mdui-textfield-label"},"模糊搜索",-1),ee=a("br",null,null,-1),te=a("br",null,null,-1),le={class:"mdui-table-fluid"},ne={class:"mdui-table mdui-table-hoverable mdui-container-flui"};d();const ae={props:{blob:Object,update:Object},setup(e){const t=e;const{addEntry:s,remoteEntry:u,db:d,bigModel:i,fildb:c,"模糊搜索":h}=function(){const e=r({"模糊搜索":"",db:[],bigModel:!0,remoteEntry(t){e.db=e.db.filter((e=>t.id!==e.id)),console.log("DB:删除数据",t)},addEntry(){const t={id:Date.now(),"属性":I.取随机属性,"长度":1,"地址":"0x"+E(5e4).toString(16).toUpperCase(),"自定义值":"","备注":"","序列":0};e.db.push(t),console.log("DB:添加数据",t)},fildb:C((()=>{const t={db:e.db,bigModel:e.bigModel};localStorage.setItem("config",JSON.stringify(t)),console.log("数据发生变化",e.db);return e.db.filter((t=>{if(e.模糊搜索){let l="";for(const e of Object.entries(t))l+=e.join("\n");return l.includes(e.模糊搜索)}return!0}))}))});return p((()=>t.update),(t=>{console.log("收到邻居数据更新db",t),e.bigModel=t.bigModel,e.db=t.db})),function(){var t,l;try{const n=JSON.parse(localStorage.getItem("config"));n&&(e.db=null!=(t=null==n?void 0:n.db)?t:e.db,e.bigModel=null!=(l=null==n?void 0:n.bigModel)?l:e.bigModel);const a=localStorage.getItem("db");a&&(e.db=JSON.parse(null!=a?a:"[]"),localStorage.removeItem("db"))}catch(n){localStorage.removeItem("config")}}(),b(e)}(),y=["属性","长度","地址","自定义值","十六进制","十进制","提示","功能"];return(t,d)=>(l(),n(o,null,[a("div",X,[a("button",{class:"mdui-btn mdui-color-theme-accent mdui-ripple",onClick:d[1]||(d[1]=(...e)=>v(s)&&v(s)(...e))}," 添加条目 ")]),a("div",Y,[Z,m(a("input",{class:"mdui-textfield-input",type:"text","onUpdate:modelValue":d[2]||(d[2]=e=>x(h)?h.value=e:null)},null,512),[[g,v(h)]])]),a("label",null,f(v(i)?"大端:":"小端："),1),m(a("input",{type:"checkbox","onUpdate:modelValue":d[3]||(d[3]=e=>x(i)?i.value=e:null)},null,512),[[U,v(i)]]),ee,te,a("div",le,[a("table",ne,[a("thead",null,[a("tr",null,[(l(),n(o,null,S(y,((e,t)=>a("th",{key:t},f(e),1))),64))])]),(l(!0),n(o,null,S(v(c),(t=>(l(),n(W,{blob:e.blob,key:t.id,data:t,onRemote:v(u),bigModel:v(i)},null,8,["blob","data","onRemote","bigModel"])))),128))])])],64))},__scopeId:"data-v-41f9a38a"};u("data-v-c33a1c92");const oe={class:"shuru"},se=a("br",null,null,-1);d();const ue={name:"ShuruEx",data:()=>({blob:{},update:{}}),methods:{setBlob(e){console.log("收到子组件数据",e),this.blob=e},setDB(e){console.log("收到子组件数据",e),this.update=e}}},de=Object.assign(ue,{setup:function(e){return(e,t)=>(l(),n("div",oe,[a(P,{onBlob:e.setBlob,onUpdate:e.setDB},null,8,["onBlob","onUpdate"]),se,a(ae,{blob:e.blob,update:e.update},null,8,["blob","update"])]))}});de.__scopeId="data-v-c33a1c92";const ie={install:function(e){e.component(K.name,K),e.component(de.name,de)}};j(M).use(ie).mount("#app");
