var e=Object.defineProperty,t=(t,a,l)=>(((t,a,l)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l})(t,"symbol"!=typeof a?a+"":a,l),l);import{c as a,o as l,r as n,p as o,a as s,b as u,d,e as r,t as c,w as i,f as b,v as p,g as v,h as m,u as g,i as f,j as h,F as y,k,l as w,m as U,n as j,q as x,s as T}from"./vendor.d9c82acc.js";const C={setup:e=>(e,t)=>{const o=n("ShuruEx");return l(),a(o)},__scopeId:"data-v-0053ab60"},B=class{static get"取随机属性"(){return B.属性类目[_(B.属性类目.length)]}};let O=B;function _(e){return Math.floor(Math.random()*e)}t(O,"属性类目","\n  力量\n  敏捷\n  智力\n  生命\n  魔法\n  法防\n  物防\n  魔抗\n    ".trim().split("\n").map((e=>e.trim())));const D=class{constructor(){var e;return t(this,"data",[D.defaultData]),D.T=null!=(e=D.T)?e:this,D.T}get size(){return this.data.length}get list(){return this.data}add(e){e&&(e=Object.assign(D.defaultData,e));const t=Object.assign({},null!=e?e:{"属性":O.取随机属性,"长度":1,"地址":"0x"+_(1e5).toString(16).toUpperCase(),"数值":_(500)});this.data.push(t),console.log("DB:插入数据")}del(e=this.size-1){this.data.splice(e,1),console.log("DB:删除数据")}};let V=D;t(V,"defaultData",{"属性":O.取随机属性,"长度":1,"地址":"0x10","自定义值":500,"原始值":0,"备注":"test"}),new V;o("data-v-6c669947");const I={class:"inputs"},S=f(" 属性："),F=f(" 长度："),L=f(" 地址："),N=f(" 自定义值："),R=f(" 原始值："),q=f(" 提示：");s();const z={props:{blob:Object,endian:Boolean,data:{type:Object,default:{"属性":"力量","长度":1,"地址":"0x10","原始值":500,"自定义值":500,"备注":"test",addr:200}}},setup(e){const t=e,n=u(!1),o=d((()=>({color:n.value?"darkgreen":"red",backgroundColor:n.value?"aquamarine":"#000"}))),s=d((()=>t.blob?n.value?"读取成功":"地址超出范围":(n.value=!1,"还没有读入文件"))),f=r(t.data),{"长度":h,"地址":y}=c(f);return i([h,y],(([e,a])=>{if(!t.blob)return;const l=t.blob;let o=new Number(a);if(console.log(o,l.byteLength,"长度检查"),o>l.byteLength)return console.log("大于"),void(n.value=!1);n.value=!0,console.log("数据更新",n.value,l,l.byteLength);const s=new DataView(l);let u=0;switch(e){case 1:u=s.getUint8(o);break;case 2:u=s.getUint16(o);break;case 4:u=s.getUint32(o);break;default:return}t.data.原始值=u,console.log(s,22222222)})),(t,n)=>(l(),a("div",I,[S,b(v("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=t=>e.data.属性=t)},null,512),[[p,e.data.属性]]),F,b(v("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=t=>e.data.长度=t)},null,512),[[p,e.data.长度,void 0,{number:!0}]]),L,b(v("input",{type:"text","onUpdate:modelValue":n[3]||(n[3]=t=>e.data.地址=t)},null,512),[[p,e.data.地址]]),N,b(v("input",{type:"text","onUpdate:modelValue":n[4]||(n[4]=t=>e.data.自定义值=t),placeholder:"修改的值"},null,512),[[p,e.data.自定义值]]),R,v("label",null,m(e.data.原始值),1),q,v("label",{style:g(o)},m(g(s)),5),v("button",{onClick:n[5]||(n[5]=e=>t.$emit("remote"))},"❌")]))},__scopeId:"data-v-6c669947"};const A={emits:["blob"],setup(e,{emit:t}){const{inNesFile:n,inJson:o}=function(){const e=r({inNesFile:null,inJson:null});return c(e)}(),s=u(),p=u("把文件拖放进来"),f=u(!1),w=d((()=>({color:f.value?"darkgreen":"red",backgroundColor:f.value?"aquamarine":"#000"})));function U(){!function(e,t){const a=URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),l=document.createElement("a");l.style.display="none",l.href=a,l.setAttribute("download",t),document.body.appendChild(l),l.click(),document.body.removeChild(l)}(new Blob([localStorage.db]),"db.json")}const j=(e,t)=>{s.value=null!=t?t:e.target.files[0],f.value=!0,p.value="得到文件:"+s.value.name,console.log("得到文件",s)};function x(e){let t=e.dataTransfer.files;if(!t.length)throw new Error("未找到文件");j(e,t[0]),console.log("在放置区域中释放拖放")}try{i(s,(async(e,a)=>{console.log(s.value.name,"文件发生变化"),""!=s.value.name&&(t("blob",await function(e){return new Promise((t=>{var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsArrayBuffer(e)}))}(s.value)),console.log("二进制读取完毕：往父组件发送事件"))}))}catch(T){console.log(T,"读取文件失败")}return(e,t)=>(l(),a(y,null,[v("div",{onDragover:t[1]||(t[1]=h(((...t)=>e.dragover&&e.dragover(...t)),["prevent"])),onDrop:h(x,["prevent"]),class:"drop",style:g(w)},m(p.value),45,["onDrop"]),b(v("input",{ref:n,type:"file",onChange:j},null,544),[[k,!1]]),v("button",{onClick:t[2]||(t[2]=e=>g(n).click())},"导入要修改的文件"),v("button",{onClick:t[3]||(t[3]=(...t)=>e.exNesFile&&e.exNesFile(...t))},"确认修改并导出文件"),b(v("input",{ref:o,type:"file"},null,512),[[k,!1]]),v("button",{onClick:U},"导出json"),v("button",{onClick:t[4]||(t[4]=e=>g(o).click())},"导入json")],64))},__scopeId:"data-v-526a8b2c"};o("data-v-0b31349c");const E={class:"shuru"},J=v("br",null,null,-1);s();const $={name:"Shuru",components:{Tiaomu:z,InFiles:A}};const M=Object.assign($,{setup:function(e){const t=u(new V),n=u(t.value.data);i(n.value,((e,t)=>{console.log(e,t,"监听")}));const o=u();function s(e){o.value=e}return(e,u)=>(l(),a("div",E,[v(A,{onBlob:s}),J,v("button",{class:"add",onClick:u[1]||(u[1]=e=>t.value.add())},"添加"),(l(!0),a(y,null,w(n.value,((e,n)=>(l(),a(z,{blob:o.value,key:n,data:e,onDel:e=>t.value.del(n)},null,8,["blob","data","onDel"])))),128))]))}});M.__scopeId="data-v-0b31349c";const P={name:"TabTbody"};const G=Object.assign(P,{props:{blob:Object,endian:Boolean,data:{type:Object,default:{"属性":"力量","长度":1,"地址":"0x10","原始值":500,"自定义值":500,"备注":""}}},setup:function(e){const t=e,n=u(!1),o=d((()=>({color:n.value?"darkgreen":"red",backgroundColor:n.value?"aquamarine":"#000"}))),s=d((()=>t.blob?n.value?"读取成功":"地址超出范围":(n.value=!1,"还没有读入文件"))),f=r(t.data),{"长度":h,"地址":y}=c(f),k=u();return i([h,y,()=>t.blob],(()=>{!function(){const e=t.blob;if(!(e instanceof ArrayBuffer))return;let a=new Number(y.value);if(console.log("长度检查:",a,e.byteLength),a>e.byteLength)return console.log("大于"),void(n.value=!1);n.value=!0,console.log("数据更新",n.value,e,e.byteLength);const l=new DataView(e);let o=0;switch(h.value){case 1:o=l.getUint8(a);break;case 2:o=l.getUint16(a);break;case 4:o=l.getUint32(a);break;default:return}k.value=o,console.log(l,22222222)}(),console.log(h.value,y.value,66666666)})),(t,n)=>(l(),a("tbody",null,[v("tr",null,[v("td",null,[b(v("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=t=>e.data.属性=t)},null,512),[[p,e.data.属性,void 0,{trim:!0}]])]),v("td",null,[b(v("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=t=>e.data.长度=t)},null,512),[[p,e.data.长度,void 0,{number:!0}]])]),v("td",null,[b(v("input",{class:"zhong",type:"text","onUpdate:modelValue":n[3]||(n[3]=t=>e.data.地址=t),placeholder:"十六进制"},null,512),[[p,e.data.地址,void 0,{trim:!0}]])]),v("td",null,[b(v("input",{type:"number","onUpdate:modelValue":n[4]||(n[4]=t=>e.data.自定义值=t),placeholder:"十进制"},null,512),[[p,e.data.自定义值]])]),v("td",null,[b(v("input",{class:"zhong",type:"text","onUpdate:modelValue":n[5]||(n[5]=t=>e.data.备注=t),placeholder:"详细描述"},null,512),[[p,e.data.备注]])]),v("td",null,[v("label",null,m(k.value),1)]),v("td",null,[v("label",{class:"msg",style:g(o)},m(g(s)),5)]),v("th",null,[v("button",{onClick:n[6]||(n[6]=a=>t.$emit("remote",e.data))},"❌")]),U(t.$slots,"default",{},void 0,!0)])]))}});G.__scopeId="data-v-566488f8";const H=x();o("data-v-19ba0b70");const K={class:"样式功能按钮"};s();const Q={name:"Tab",components:{TabTbody:G},props:{blob:Object},data(){var e;return{db:JSON.parse(null!=(e=localStorage.db)?e:"[]"),key:0,th:["属性","长度","地址","自定义值","备注","原始值","提示"],"模糊搜索":""}},methods:{addTodo(){this.db.push({id:this.key++,"属性":O.取随机属性,"长度":1,"地址":"0x"+_(5e4).toString(16).toUpperCase(),"自定义值":"","备注":""}),console.log(this.db,"DB")},remoteTodo(e){this.db=this.db.filter((t=>e.id!==t.id)),console.log("DB:删除数据",e)}},computed:{fildb(){return localStorage.db=JSON.stringify(this.db),this.db.filter((e=>{if(this.模糊搜索){let t="";for(const a of Object.entries(e))t+=a.join("\n");return t.includes(this.模糊搜索)}return!0}))}}};const W=Object.assign(Q,{setup:function(e){return(t,n)=>(l(),a(y,null,[v("div",K,[v("button",{class:"add",onClick:n[1]||(n[1]=(...e)=>t.addTodo&&t.addTodo(...e))},"添加"),b(v("input",{type:"text","onUpdate:modelValue":n[2]||(n[2]=e=>j(模糊搜索)?模糊搜索.value=e:null),placeholder:"模糊搜索"},null,512),[[p,t.模糊搜索]])]),v("table",null,[v("thead",null,[v("tr",null,[(l(!0),a(y,null,w(t.th,((e,t)=>(l(),a("th",{key:t},m(e),1)))),128))])]),(l(!0),a(y,null,w(t.fildb,(n=>(l(),a(G,{blob:e.blob,key:n.id,data:n,onRemote:t.remoteTodo},{default:H((()=>[f(m(n.id),1)])),_:2},1032,["blob","data","onRemote"])))),128))])],64))}});W.__scopeId="data-v-19ba0b70";const X={name:"ShuruEx",components:{InFiles:A,Tab:W},data:()=>({blob:{}}),methods:{setBlob(e){console.log("收到子组件数据",e),this.blob=e}}},Y=x("data-v-02978f8e");o("data-v-02978f8e");const Z={class:"shuru"};s();const ee=Y(((e,t,o,s,u,d)=>{const r=n("InFiles"),c=n("Tab");return l(),a("div",Z,[v(r,{onBlob:d.setBlob},null,8,["onBlob"]),v(c,{blob:u.blob},null,8,["blob"])])}));X.render=ee,X.__scopeId="data-v-02978f8e";const te={install:function(e){e.component(M.name,M),e.component(X.name,X)}};T(C).use(te).mount("#app");
